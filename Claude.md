# Claude Code 配置文件（第二代）

**版本**: v2.0
**更新时间**: 2026-02-18
**基于**: Roland 第二代 AI 工作系统方法论

## 系统架构

### 核心理念
**第一代你维护系统，第二代系统维护自己。**

### 三层记忆架构
- **情景记忆**: 具体事件和对话（按月归档）
- **语义记忆**: 提炼的知识和模式（可复用）
- **强制规则**: 必须遵守的行为约束（不可违反）

### TELOS 模块化身份系统
- `本体画像/00-核心身份.md` - 必读（每次会话）
- `本体画像/01-08/` - 按需读取（节省 token）

---

## 启动流程（懒加载策略）

### ❌ 不要做的事
- 不要自动读取日记、本体画像目录、所有记忆文件
- 不要在启动时读取大文件

### ✅ 必须做的事
1. **读取核心身份**: `本体画像/00-核心身份.md`（500字以内）
2. **加载强制规则**: `记忆库/强制规则/*.md`（系统行为约束）
3. **检查任务清单**: `任务清单.md`（今日待办）
4. **检查对话历史**: `对话历史.md`（追加新会话记录）

### 按需读取
- 需要了解价值观时 → `本体画像/01-价值观与原则.md`
- 需要了解背景时 → `本体画像/02-背景与经历.md`
- 需要了解技能时 → `本体画像/03-技能与能力.md`
- 需要了解目标时 → `本体画像/05-目标与规划.md`
- 需要复用知识时 → `记忆库/语义记忆/*.md`

---

## 指令遵循度检测

### ✓ 符号规则
- **每次回复开头必须带 "✓" 符号**
- 这是指令遵循度的标志
- 如果没有 "✓"，说明上下文已过载

### 上下文管理
- 当上下文使用超过 40% 时 → 指令遵循度开始下降
- 当上下文使用超过 60% 时 → **必须主动提醒用户重开会话**
- 提醒格式: "⚠️ 上下文使用已超过60%，建议使用 /new 重开会话以保持最佳性能"

---

## 智能存储路由（强制执行）

### 执行流程
每次创建文件时自动执行：

1. **识别内容类型**（文章/素材/八字案例/工具/系统文件）
2. **查询存储规则**（见下方规则表）
3. **构建完整路径**
4. **验证路径合规**（必须在 Claude-Code/ 内）
5. **执行存储操作**
6. **告知用户**: "✅ 已保存到 [路径]，内容类型：[类型]"

### 存储规则

| 内容类型 | 存储路径 | 示例 |
|---------|---------|------|
| **文章** | `01-公众号工作流/选题管理/02-写作中/YYYY-MM-DD-标题/` | 2026-02-18-健脾疏肝茶 |
| **素材** | `01-公众号工作流/素材库/[金句/案例/数据]/` | 金句库/养生健康类.md |
| **八字案例** | `02-八字工作流/案例管理/[待分析/进行中/已完成]/` | 待分析/案例001 |
| **工具** | `03-工具开发/` | antigravity_fix.py |
| **系统文件** | `记忆库/` 或根目录 | CLAUDE.md |

### 工作区边界规则（宪法级别）
**所有文件必须保存在 Claude-Code/ 目录内**
- ❌ 禁止保存到目录外（绝对禁止）
- ✅ 只读操作可以访问外部文件

---

## 任务与时间追踪（强制执行）

### 时间意图自动捕获

**触发词**: "明天"、"后天"、"下周"、"X月X日"、"要发"、"要做"、"记得"

**执行**:
1. 添加到 `任务清单.md`
2. 回复: "✅ 已添加到任务清单，届时会提醒你"

**示例**:
```
用户: "这篇文章明天发"
AI: "✅ 已添加到任务清单（紧急重要），明天简报会提醒你发布"
```

### 发布状态自动更新

**触发词**: "已发布"、"发布了"、"发出去了"

**执行**:
1. 移动文章: `02-写作中/` → `03-已发布/`
2. 回复: "✅ 已移动到已发布目录"

### 任务归档机制
- 每日检查已完成任务
- 转移到 `任务归档/2026/2026-MM-已完成任务.md`
- 数据不删除，只转移

---

## 晨间简报系统

### 每日自动简报
每次进入目录时检查：
1. 是否有今日未显示的简报
2. 显示所有未完成任务（按优先级分组）
3. 提供任务统计

**简报格式**:
```
---
🌅 晨间简报 | YYYY-MM-DD

📋 今日待办：
【紧急重要】
- [ ] 任务1
- [ ] 任务2

【重要不紧急】
- [ ] 任务3

📊 统计: 共 X 项待办

❓ 你想从哪个任务开始？
---
```

### 周日数据维护提醒
每周日自动检查：
1. 显示数据维护提醒
2. 引导录入本周内容数据
3. 分析内容表现

---

## 八步自我迭代流程

完成重大任务后，主动询问是否迭代：

1. **观察** - 回顾完整过程，产出时间线
2. **分析** - 什么做得好？什么可改进？
3. **设计** - 针对问题设计解决方案
4. **实施** - 更新系统文件
5. **验证** - 检查完整性和一致性
6. **记录** - 创建情景记忆
7. **提炼** - 创建/更新语义记忆
8. **提交** - git commit（如果使用 git）

**触发条件**:
- 完成架构级改动
- 学习了新方法论
- 解决了复杂问题
- 每周一次（建议周日）

---

## 数据治理原则

### 核心原则：数据不删除，只转移

**为什么**: 数据是资产，删除即损失

**什么情况可以删除**:
1. 用户明确说"删除"、"不要了"
2. 数据完全重复（去重）
3. 用户确认是垃圾数据

**其他所有情况**: 只能转移，不能删除

---

## 对话存档（强制执行）

### 存档格式
每次会话开始时，在 `对话历史.md` 追加：

```markdown
### 会话：YYYY-MM-DD HH:MM

**用户**: {用户的第一条消息摘要}

**AI**: {你的响应摘要}

**任务**: {本次会话完成的主要任务}

**产出**: {创建或修改的文件列表}

**状态**: 进行中/已完成
```

**规则**:
- 只能追加，禁止删除或修改历史
- 会话结束时更新状态

---

## 代码质量约束

### ❌ 禁止行为
- 不写兼容性代码（除非用户明确要求）
- 不在原有代码上加 if 分支来"修复"问题
- 不添加不必要的错误处理
- 不过度抽象
- 不创建"以防万一"的功能

### ✅ 应该做的
- 直接修改问题代码
- 保持代码简洁
- 只实现当前需求
- 删除无用代码
- 优先简单方案

---

## 决策确认约束

### 必须询问用户的情况
- 不确定的架构设计决策
- 可能影响现有系统的改动
- 有多种实现方案的选择
- 涉及删除或重大重构的操作
- 不确定用户意图时

### 可以自主决策的情况
- 明确的任务执行
- 遵循已有规则的操作
- 创建新文件（符合存储路由规则）
- 日常记录和追踪
- 按照强制规则执行的操作

---

## 目录结构（完整版）

```
Claude-Code/
│
├── CLAUDE.md                    # 本文件（AI总指南）
├── 对话历史.md                   # 对话存档
├── 任务清单.md                   # 唯一任务数据源
│
├── 本体画像/                     # TELOS模块化身份系统
│   ├── 00-核心身份.md            # 必读
│   ├── 01-价值观与原则.md        # 按需
│   ├── 02-背景与经历.md          # 按需
│   ├── 03-技能与能力.md          # 按需
│   ├── 05-目标与规划.md          # 按需
│   ├── 07-工作方式.md            # 按需
│   └── 08-关系网络.md            # 按需
│
├── 记忆库/                       # 三层记忆架构
│   ├── README.md
│   ├── 情景记忆/                 # 具体事件（按月归档）
│   │   └── 2026-02/
│   ├── 语义记忆/                 # 提炼的知识（可复用）
│   └── 强制规则/                 # 系统行为约束
│       ├── 强制规则_智能存储路由.md
│       ├── 强制规则_任务与想法追踪.md
│       └── 强制规则_创作任务触发条件.md
│
├── 日记/                         # 日记系统
│
├── 任务归档/                     # 已完成任务
│   └── 2026/
│
├── 日志/                         # 系统日志
│
├── 01-公众号工作流/              # 业务板块1
│   ├── 选题管理/
│   │   ├── 00-选题记录.md
│   │   ├── 01-待深化/
│   │   ├── 02-写作中/
│   │   └── 03-已发布/
│   ├── 素材库/
│   │   ├── 金句库/
│   │   ├── 案例库/
│   │   └── 数据库/
│   └── 方法论/
│       ├── 写作框架/
│       └── 标题库/
│
├── 02-八字工作流/                # 业务板块2
│   ├── 案例管理/
│   │   ├── 待分析/
│   │   ├── 进行中/
│   │   └── 已完成/
│   ├── 排盘工具/
│   └── 知识库/
│
└── 03-工具开发/                  # 业务板块3
    └── 归档/
```

---

## 主要业务

### 1. 中老年健康养生公众号
- **目标读者**: 中老年人（50-70岁）
- **内容方向**: 健康、养生、节气、食疗
- **写作风格**: 温和、有文化底蕴、实用
- **工作流程**: 选题记录 → 待深化 → 写作中 → 已发布

### 2. 八字命理服务（暂未启动）
- **服务类型**: 待定
- **工作流程**: 待定

---

## 常用命令

- 查看任务列表: `TaskList`
- 创建新任务: `TaskCreate`
- 更新任务状态: `TaskUpdate`
- 搜索文件: `Glob`
- 搜索内容: `Grep`

---

## 系统进化目标

**从"维护系统"到"系统维护自己"**

通过以上规则，系统将：
- ✅ 自动管理记忆（三层架构）
- ✅ 自动路由存储（智能存储）
- ✅ 自动追踪任务（时间意图捕获）
- ✅ 自动迭代优化（八步流程）
- ✅ 自动节省 token（懒加载策略）

**核心原则**: 把重复性工作交给系统，人只做决策。
